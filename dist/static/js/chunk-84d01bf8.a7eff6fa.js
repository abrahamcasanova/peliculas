(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-84d01bf8"],{"3ced":function(e,t,r){},6355:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-main",{staticClass:"ma-10"},[r("v-card",[r("v-card-title",[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,n=t.attrs;return[r("v-btn",e._g(e._b({attrs:{color:"primary mr-3",dark:""},on:{click:e.showModal}},"v-btn",n,!1),a),[r("v-icon",{staticClass:"mr-2",attrs:{right:"",dark:""}},[e._v(" mdi-plus ")]),e._v(" Nuevo ")],1)]}}])},[r("span",[e._v("Crear nuevo usuario")])]),e._v(" Usuarios "),r("v-spacer"),r("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.list,search:e.search,"items-per-page":5,loading:e.listLoading,"footer-props":{itemsPerPageText:"Filas por página",itemsPerPageAll:"Todos",itemsPerPageOptions:[10,20]},"loading-text":"Cargando....... Espere un momento"},scopedSlots:e._u([{key:"item.roles",fn:function(t){var a=t.item;return[null!=a.roles[0]?r("v-chip",{attrs:{color:e.getColor(a.roles[0].name),dark:""}},[e._v(" "+e._s(a.roles[0].name)+" ")]):e._e()]}},{key:"item.actions",fn:function(t){var a=t.item;return[r("v-row",{attrs:{align:"center",justify:"space-around"}},[r("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on,i=t.attrs;return[e.checkSpecificPermission("edit-user")?r("v-btn",e._g(e._b({staticClass:"mx-2",attrs:{fab:"",dark:"","x-small":"",color:"green"},on:{click:function(t){return e.editUser(a)}}},"v-btn",i,!1),n),[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-pencil ")])],1):e._e()]}}],null,!0)},[r("span",[e._v("Editar usuario")])]),r("el-popconfirm",{attrs:{title:"¿Eliminar usuario?","confirm-button-text":"Eliminar","cancel-button-text":"Cancelar","confirm-button-type":"danger force-white-color"},on:{confirm:function(t){return e.deleteUser(a)}}},[e.checkSpecificPermission("delete-user")?r("v-btn",{staticClass:"mx-2",attrs:{slot:"reference",fab:"",dark:"","x-small":"",color:"red"},slot:"reference"},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-delete-variant ")])],1):e._e()],1)],1)]}}],null,!0)})],1),r("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:e.dialogLoading,callback:function(t){e.dialogLoading=t},expression:"dialogLoading"}},[r("v-card",{attrs:{color:"primary",dark:""}},[r("v-card-text",[e._v(" Guardando.... espera un momento "),r("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),[r("v-row",{attrs:{justify:"center"}},[r("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v("Perfil de usuario (nuevo)")])]),r("v-card-text",[r("v-container",[r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Nombre",rules:e.nameRules,required:""},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),r("v-col",{attrs:{cols:"6",md:"6"}},[r("v-text-field",{attrs:{label:"Correo electronico*",type:"email",rules:e.emailRules,required:""},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),r("v-col",{attrs:{cols:"6",md:"6"}},[r("v-text-field",{attrs:{label:"Contraseña*",type:"password",rules:e.passwordRules,required:""},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-autocomplete",{attrs:{required:"",rules:e.rolRules,items:e.roles,chips:"","item-text":"name","item-value":"name","small-chips":"",clearable:"",label:"Rol*"},model:{value:e.user.rol,callback:function(t){e.$set(e.user,"rol",t)},expression:"user.rol"}})],1)],1)],1)],1),r("small",{staticClass:"red--text"},[e._v("*Campos obligatorios")])],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"grey darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(" Cerrar ")]),0==e.isUpdate?r("v-btn",{attrs:{color:"primary darken-1",text:""},on:{click:function(t){return e.saveUser()}}},[e._v(" Guardar ")]):r("v-btn",{attrs:{color:"primary darken-1",text:""},on:{click:function(t){return e.updateUser()}}},[e._v(" Actualizar ")])],1)],1)],1)],1)]],2)},n=[],i=r("1da1"),s=(r("96cf"),r("fb6a"),r("b0c0"),r("c24f")),o=r("cc5e"),l=r("e350"),c={name:"Users",filters:{statusFilter:function(e){var t={published:"success",draft:"info",deleted:"danger"};return t[e]}},data:function(){return{list:[],total:0,visible:!1,isUpdate:!1,dialog:!1,valid:!1,user:{name:"",email:""},listLoading:!0,roles:[],filterText:void 0,dialogLoading:!1,emailRules:[function(e){return!!e||"Correo electronico es requerido"},function(e){return/.+@.+\..+/.test(e)||"Correo electronico invalido"}],nameRules:[function(e){return!!e||"Nombre es requerido"}],passwordRules:[function(e){return!!e||"Contraseña es requerido"},function(e){return e&&e.length>=5||"Contraseña tiene que tener al menos 5 carácteres"}],rolRules:[function(e){return!!e||"Rol es requerido"}],listQuery:{page:1,limit:10,importance:void 0,title:void 0,type:void 0,sort:"+id"},orders:[],headers:[{value:"id",align:"center",text:"Folio"},{value:"name",text:"Nombre",sortable:!0},{value:"roles",align:"center",text:"Rol",sortable:!0},{value:"email",text:"Correo",sortable:!0},{value:"created_at",with:"100%",sortable:!0,align:"right",text:"Registrado"},{value:"actions",text:"Acciones",sortable:!1}],search:""}},computed:{displayData:function(){return this.list&&0!==this.list.length?this.list.slice(this.listQuery.limit*this.listQuery.page-this.listQuery.limit,this.listQuery.limit*this.listQuery.page):[]}},created:function(){this.getList(),this.getRoles()},methods:{getList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,t.next=3,Object(s["c"])();case 3:r=t.sent,e.list=r,e.total=r.length,e.listLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},checkSpecificPermission:l["b"],clearInputs:function(){this.user.name=void 0,this.user.email=void 0,this.user.rol=void 0},updateUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=15;break}return e.dialog=!1,e.dialogLoading=!0,t.prev=3,t.next=6,Object(s["g"])(e.user);case 6:e.getList(),e.dialogLoading=!1,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](3),console.log("try catch"),console.log(t.t0),e.dialogLoading=!1;case 15:case"end":return t.stop()}}),t,null,[[3,10]])})))()},saveUser:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=15;break}return e.dialog=!1,e.dialogLoading=!0,t.prev=3,t.next=6,Object(s["f"])(e.user);case 6:e.getList(),e.dialogLoading=!1,t.next=15;break;case 10:t.prev=10,t.t0=t["catch"](3),console.log("try catch"),console.log(t.t0),e.dialogLoading=!1;case 15:case"end":return t.stop()}}),t,null,[[3,10]])})))()},editUser:function(e){this.clearInputs(),this.isUpdate=!0,this.user.name=e.name,this.user.id=e.id,this.user.email=e.email,this.user.rol=e.roles?e.roles[0].name:null,this.passwordRules=[],this.dialog=!0},deleteUser:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.dialogLoading=!0,r.prev=1,r.next=4,Object(s["a"])(e.id);case 4:t.getList(),t.dialogLoading=!1,r.next=13;break;case 8:r.prev=8,r.t0=r["catch"](1),console.log("try catch"),console.log(r.t0),t.dialogLoading=!1;case 13:case"end":return r.stop()}}),r,null,[[1,8]])})))()},showModal:function(){var e=this;this.clearInputs(),this.isUpdate=!1,this.passwordRules=[function(e){return!!e||"Contraseña es requerido"},function(e){return e&&e.length>=5||"Contraseña tiene que tener al menos 5 carácteres"}],this.dialog=!0,this.$nextTick((function(){e.$refs.form.resetValidation()}))},getRoles:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["c"])();case 2:r=t.sent,e.roles=r;case 4:case"end":return t.stop()}}),t)})))()},getColor:function(e){switch(e){case"admin":return"blue";case"ejecutivo":return"green";default:return"grey"}}}},u=c,d=(r("a052"),r("7ee5"),r("2877")),m=Object(d["a"])(u,a,n,!1,null,"ea89bade",null);t["default"]=m.exports},"7ee5":function(e,t,r){"use strict";r("3ced")},"95f3":function(e,t,r){},a052:function(e,t,r){"use strict";r("95f3")},cc5e:function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"e",(function(){return m})),r.d(t,"b",(function(){return v}));var a=r("2909"),n=(r("99af"),r("b775")),i=r("a18c"),s=r("ed08"),o=s.deepClone,l=o([].concat(Object(a["a"])(i["b"]),Object(a["a"])(i["a"])));function c(){return{data:l}}function u(){return Object(n["a"])({url:"/api/auth/roles",method:"get"})}function d(e){return Object(n["a"])({url:"/api/auth/roles",method:"post",data:e})}function m(e,t){return Object(n["a"])({url:"/api/auth/roles",method:"put",data:t})}function v(e){return Object(n["a"])({url:"/api/auth/roles/".concat(e),method:"delete"})}},e350:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));r("caad"),r("2532"),r("4de4");var a=r("4360");function n(e){if(e&&e instanceof Array&&e.length>0){var t=a["a"].getters&&a["a"].getters.roles,r=e,n=t.some((function(e){return r.includes(e)}));return n}return console.error("need roles! Like v-permission=\"['admin','editor']\""),!1}function i(e){if(e){var t=a["a"].getters&&a["a"].getters.userRoutes;if(t||(t=JSON.parse(localStorage.getItem("routes"))),!t)return!1;var r=e,n=t.filter((function(e){return e.meta&&e.meta.permissions})),i=n.some((function(e){return e.meta.permissions.includes(r)}));return i}return console.error("need roles! Like v-permission=\"['admin','editor'] custom....\""),!1}}}]);